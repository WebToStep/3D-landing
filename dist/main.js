(()=>{"use strict";const e=e=>{const t=document.querySelector("#timer-hours"),o=document.querySelector("#timer-minutes"),r=document.querySelector("#timer-seconds"),n=()=>{const n=(new Date(e).getTime()-(new Date).getTime())/1e3,s=("0"+Math.floor(n%60)).slice(-2),a=("0"+Math.floor(n/60%60)).slice(-2),c=("0"+Math.floor(n/60/60)).slice(-2);return t.textContent=c,o.textContent=a,r.textContent=s,n};(()=>{let e;n()>0?e=setInterval(n,1e3):(clearInterval(e),t.textContent="00",o.textContent="00",r.textContent="00")})()};class t{constructor({selector:e,pattern:t={},method:o,errorMessage:r}){this.form=document.querySelector(e),this.pattern=t,this.method=o,this.elementsForm=[...this.form.elements].filter((e=>"button"!==e.tagName.toLowerCase()&&"button"!==e.type)),this.errorMessage=r}init(){this.applyStyle(),this.setPattern(),this.elementsForm.forEach((e=>{e.addEventListener("input",this.checkIt.bind(this)),e.addEventListener("blur",(()=>{e.getAttribute("id").includes("name")&&1===e.value.length&&(e.value="",this.showError(e,this.errorMessage))}))}))}isValid(e){const t={notEmpty:e=>""!==e.value.trim(),pattern:(e,t)=>t.test(e.value)};if(this.method){const o=this.method[e.id];if(o)return o.every((o=>t[o[0]](e,this.pattern[o[1]])))}else console.warn("Необходимо передать id полей ввода и методы проверки этих полей!");return!0}checkIt(e){const t=e.target;this.isValid(t)?this.isValid(t)&&this.showSuccess(t):(t.value="",this.showError(t,this.errorMessage))}showError(e,t){let o;e.classList.remove("success"),e.classList.add("error");const r=document.createElement("div");r.textContent=t?t[e.id]:"Ошибка в поле"+e.placeholder.toLowerCase(),r.classList.add("validator-error"),document.body.querySelector(".validator-error")?(document.body.querySelector(".validator-error").remove(),clearTimeout(o),this.showError(e,this.errorMessage)):(document.body.append(r),o=setTimeout((()=>{r.classList.add("active"),setTimeout((()=>{r.classList.add("hide"),setTimeout((()=>{r.remove()}),4e3)}),3e3)}),10))}showSuccess(e){e.classList.remove("error"),e.classList.add("success"),e.nextElementSibling&&e.nextElementSibling.classList.contains("validator-error")&&e.nextElementSibling.remove()}applyStyle(){const e=document.createElement("style");e.textContent="\n      input.success{\n         border: 2px solid #4CAF50 !important;\n      }\n      input.error{\n         border: 2px solid #af4c4c !important;\n         background: #ffd1d1 !important;\n      }\n      .validator-error{\n        position:fixed !important;\n        right: 20px !important;\n        bottom: 20px !important;\n         background: #fff;\n         padding:5px 10px;\n         width: 200px;\n         min-height: 50px;\n         margin: 0px auto;\n         text-align: center; \n         border-radius: 0 2px 2px 0;\n         border-left: 3px solid #af4c4c;\n         font-size:12px;\n         fontFamily: sans-serif;\n         color:#af4c4c; \n         background: #ffd1d1 !important;\n         opacity: 1 !important;\n         transform: translateY(150%) !important;\n         transition: 1s transform, opacity 4s;\n         z-index:1000;\n        }\n        .validator-error.active{\n          transform: translateY(0) !important;\n        display:unset;\n      }\n      .validator-error.hide{\n        opacity: 0 !important;\n      display:unset;\n    }",document.head.appendChild(e)}setPattern(){this.pattern.phone||(this.pattern.phone=/^\+?[78]([-()]*\d){10}$/),this.pattern.email||(this.pattern.email=/^\w+@\w+\.\w{2,}$/)}}const o=new t({selector:"#form1",pattern:{name:/[а-я ]/gi,email:/[\w\s\S@]/gi,phone:/[0-9+]/gi},method:{"form1-name":[["notEmpty"],["pattern","name"]],"form1-phone":[["notEmpty"],["pattern","phone"]],"form1-email":[["notEmpty"],["pattern","email"]]},errorMessage:{"form1-name":"Имя должно быть более 2х символов, Русского алфавита","form1-phone":"Телефон может содержать только цифры и знак +","form1-email":"Имя должно быть более 2х символов, Русского алфавита"}}),r=new t({selector:"#form2",pattern:{name:/[а-я ]/gi,email:/[\w\s\S@]/gi,phone:/[0-9+]/gi,text:/[\w\s\S-.?!)(,:]/gi},method:{"form2-name":[["notEmpty"],["pattern","name"]],"form2-phone":[["notEmpty"],["pattern","phone"]],"form2-email":[["notEmpty"],["pattern","email"]],"form2-message":[["notEmpty"],["pattern","text"]]}}),n=new t({selector:"#form3",pattern:{name:/[а-я ]/gi,email:/[\w\s\S@]/gi,phone:/[0-9+]/gi},method:{"form3-name":[["notEmpty"],["pattern","name"]],"form3-phone":[["notEmpty"],["pattern","phone"]],"form3-email":[["notEmpty"],["pattern","email"]]}});void 0===localStorage.startTimer?(localStorage.startTimer=((e,t)=>{const o=new Date(e);return o.setDate(o.getDate()+1),o})(new Date),e(localStorage.startTimer)):e(localStorage.startTimer),(()=>{const e=document.querySelector("menu");document.addEventListener("click",(t=>{const o=t.target;"active-menu"===e.className&&o.closest("a")?(t.preventDefault(),e.classList.toggle("active-menu")):"active-menu"!==e.className&&o.closest(".menu")?e.classList.toggle("active-menu"):"active-menu"!==e.className||o.closest("menu")||e.classList.toggle("active-menu")}))})(),(()=>{const e=document.querySelector(".popup"),t=document.querySelector(".popup-content");document.querySelectorAll(".popup-btn").forEach((o=>{o.addEventListener("click",(()=>{if(e.style.display="block",screen.width>768){let e=-60,o=0;t.style.opacity=o;const r=()=>{const n=requestAnimationFrame(r);e<=10?(e+=10,o+=.13,t.style.top=e+"%",t.style.opacity=o):cancelAnimationFrame(n)};r()}const o=t=>{"popup"!==t.target.className&&"popup-close"!==t.target.className||(e.style.display="none",e.removeEventListener("click",o))};e.addEventListener("click",(e=>o(e)))}))}))})(),document.querySelectorAll("a").forEach((e=>{const t=e.hash;"#"===e.hash[0]&&"#close"!==e.hash&&e.addEventListener("click",(e=>{e.preventDefault(),document.querySelector(t).scrollIntoView({behavior:"smooth",block:"start"})}))})),(()=>{const e=document.querySelector(".service-header"),t=document.querySelectorAll(".service-header-tab"),o=document.querySelectorAll(".service-tab");e.addEventListener("click",(e=>{let r=e.target;r=r.closest(".service-header-tab"),r.classList.contains("service-header-tab")&&t.forEach(((e,n)=>{e===r&&(e=>{for(let r=0;r<o.length;r++)e===r?(t[r].classList.add("active"),o[r].classList.remove("d-none")):(t[r].classList.remove("active"),o[r].classList.add("d-none"))})(n)}))}))})(),(()=>{const e=document.querySelectorAll(".portfolio-item"),t=document.querySelector(".portfolio-content"),o=document.querySelector(".portfolio-dots");let r,n=0;e.forEach((()=>{const e=document.createElement("li");e.classList.add("dot"),o.append(e)}));const s=document.querySelectorAll(".dot");s[0].classList.add("dot-active");const a=(e,t,o)=>{e[t].classList.remove(o)},c=(e,t,o)=>{e[t].classList.add(o)},i=()=>{a(e,n,"portfolio-item-active"),a(s,n,"dot-active"),n++,n>=e.length&&(n=0),c(e,n,"portfolio-item-active"),c(s,n,"dot-active")},l=(e=3e3)=>{r=setInterval(i,e)};t.addEventListener("click",(t=>{t.preventDefault();const o=t.target;o.matches(".portfolio-btn, .dot")&&(a(e,n,"portfolio-item-active"),a(s,n,"dot-active"),o.matches("#arrow-right")?n++:o.matches("#arrow-left")?n--:o.matches(".dot")&&s.forEach(((e,t)=>{e===o&&(n=t)})),n>=e.length&&(n=0),n<0&&(n=e.length-1),c(e,n,"portfolio-item-active"),c(s,n,"dot-active"))})),t.addEventListener("mouseover",(e=>{e.target.matches(".portfolio-btn, .dot")&&clearInterval(r)})),t.addEventListener("mouseout",(e=>{e.target.matches(".portfolio-btn, .dot")&&l()})),l(3e3)})(),(()=>{const e=document.getElementById("command"),t=e=>{e.target.matches(".command__photo")&&(e.target.getAttribute("src")===e.target.dataset.img?e.target.setAttribute("src",e.target.dataset.img.replace(/a\.jpg/,".jpg")):e.target.src=e.target.dataset.img)};e.addEventListener("mouseover",t),e.addEventListener("mouseout",t)})(),((e=100)=>{const t=document.querySelector(".calc-block"),o=document.querySelector(".calc-type"),r=document.querySelector(".calc-square"),n=document.querySelector(".calc-day"),s=document.querySelector(".calc-count"),a=document.getElementById("total");t.addEventListener("change",(t=>{const c=t.target;(c.matches("select")||c.matches("input"))&&(()=>{let t=0,c=1,i=1;const l=o.options[o.selectedIndex].value,d=+r.value;s.value>1&&(i+=(s.value-1)/10),n.value&&n.value<5?c*=2:n.value&&n.value<10&&(c*=1.5),l&&d&&(t=e*l*d*i*c,(e=>{let t=0;const o=setInterval((()=>{t<e&&(t+=e/100,t>e&&(a.textContent=Math.round(e),clearInterval(o))),t===e&&(a.textContent=Math.round(e),clearInterval(o)),a.textContent=Math.round(t)}),1)})(t))})()}))})(100),o.init(),r.init(),n.init(),document.querySelectorAll("form").forEach((e=>{e.addEventListener("submit",(t=>{const o=document.createElement("div");o.style.cssText="font-size: 2rem;\n                                          color: #fff !important;";const r=document.createElement("section");r.innerHTML="<div class='sk-circle-bounce'>\n                                       <div class='sk-child sk-circle-1'></div>\n                                       <div class='sk-child sk-circle-2'></div>\n                                       <div class='sk-child sk-circle-3'></div>\n                                       <div class='sk-child sk-circle-4'></div>\n                                       <div class='sk-child sk-circle-5'></div>\n                                       <div class='sk-child sk-circle-6'></div>\n                                       <div class='sk-child sk-circle-7'></div>\n                                       <div class='sk-child sk-circle-8'></div>\n                                       <div class='sk-child sk-circle-9'></div>\n                                       <div class='sk-child sk-circle-10'></div>\n                                       <div class='sk-child sk-circle-11'></div>\n                                       <div class='sk-child sk-circle-12'></div>\n                                   </div>",t.preventDefault(),e.append(o),o.append(r);const n=new FormData(e),s={};n.forEach(((e,t)=>s[t]=e)),(e=>fetch("./server.php",{method:"POST",headers:{"Content-Type":"aplication/json"},body:JSON.stringify(e)}))(s).then((e=>{if(200!==e.status)throw new Error(e.status);o.textContent="Спасибо! Мы скоро с вами свяжемся!"})).catch((e=>{o.textContent="Что то пошло не так...",console.error(e)})),t.target.querySelectorAll("input").forEach((e=>e.value="")),e.querySelectorAll("input").forEach((e=>e.classList.remove("success"))),setTimeout((()=>o.remove()),5e3)}))}))})();